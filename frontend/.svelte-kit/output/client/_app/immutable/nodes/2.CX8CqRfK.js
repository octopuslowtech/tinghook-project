import{c as _,a as u,f as b}from"../chunks/BIHYj5q8.js";import{w as G,o as J,a as R}from"../chunks/C1N3qTNx.js";import{f as g,p as H,c as $,t as D,o as P,s as m,r as h,v as I,k as N,e as Z,w as L,q as K}from"../chunks/CNB1M18W.js";import{d as W}from"../chunks/BovVG3Uo.js";import{i as U}from"../chunks/Ny0y5trL.js";import{s as Q}from"../chunks/DeLv-j5j.js";import{l as x,s as y,p as X,a as T,b as C}from"../chunks/u9c0W3Mj.js";import{s as j}from"../chunks/YAzIAqS4.js";import{I as w,s as M,e as Y,i as ee}from"../chunks/AC_Dnq90.js";import{c as te}from"../chunks/BuBRG_9U.js";import{s as O,c as ae}from"../chunks/DtRFns2F.js";import{s as se,g as A}from"../chunks/CO2uuHXI.js";import{a as E}from"../chunks/Cc8-o5IQ.js";import"../chunks/BO5QB-9v.js";import{S as oe}from"../chunks/BP0Atx3p.js";import{B as ne}from"../chunks/DxAib77k.js";import{i as re}from"../chunks/BGN4csYZ.js";const ie=()=>{const s=se;return{page:{subscribe:s.page.subscribe},navigating:{subscribe:s.navigating.subscribe},updated:s.updated}},ce={subscribe(s){return ie().page.subscribe(s)}};function le(s,t){const o=x(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.460.1 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}],["path",{d:"M10 9H8"}],["path",{d:"M16 13H8"}],["path",{d:"M16 17H8"}]];w(s,y({name:"file-text"},()=>o,{get iconNode(){return a},children:(r,n)=>{var e=_(),i=g(e);M(i,t,"default",{}),u(r,e)},$$slots:{default:!0}}))}function de(s,t){const o=x(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.460.1 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1"}]];w(s,y({name:"layout-dashboard"},()=>o,{get iconNode(){return a},children:(r,n)=>{var e=_(),i=g(e);M(i,t,"default",{}),u(r,e)},$$slots:{default:!0}}))}function ue(s,t){const o=x(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.460.1 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}],["polyline",{points:"16 17 21 12 16 7"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12"}]];w(s,y({name:"log-out"},()=>o,{get iconNode(){return a},children:(r,n)=>{var e=_(),i=g(e);M(i,t,"default",{}),u(r,e)},$$slots:{default:!0}}))}function fe(s,t){const o=x(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.460.1 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a=[["line",{x1:"4",x2:"20",y1:"12",y2:"12"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18"}]];w(s,y({name:"menu"},()=>o,{get iconNode(){return a},children:(r,n)=>{var e=_(),i=g(e);M(i,t,"default",{}),u(r,e)},$$slots:{default:!0}}))}function ve(s,t){const o=x(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.460.1 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}],["circle",{cx:"12",cy:"12",r:"3"}]];w(s,y({name:"settings"},()=>o,{get iconNode(){return a},children:(r,n)=>{var e=_(),i=g(e);M(i,t,"default",{}),u(r,e)},$$slots:{default:!0}}))}function he(s,t){const o=x(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.460.1 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}],["circle",{cx:"12",cy:"7",r:"4"}]];w(s,y({name:"user"},()=>o,{get iconNode(){return a},children:(r,n)=>{var e=_(),i=g(e);M(i,t,"default",{}),u(r,e)},$$slots:{default:!0}}))}function pe(s,t){const o=x(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.460.1 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a=[["path",{d:"M12 20h.01"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764"}],["path",{d:"m2 2 20 20"}]];w(s,y({name:"wifi-off"},()=>o,{get iconNode(){return a},children:(r,n)=>{var e=_(),i=g(e);M(i,t,"default",{}),u(r,e)},$$slots:{default:!0}}))}function $e(s,t){const o=x(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.460.1 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a=[["path",{d:"M12 20h.01"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0"}]];w(s,y({name:"wifi"},()=>o,{get iconNode(){return a},children:(r,n)=>{var e=_(),i=g(e);M(i,t,"default",{}),u(r,e)},$$slots:{default:!0}}))}var ge=b("<a><!> </a>"),me=b('<aside><div class="p-6"><h1 class="text-2xl font-bold">TingHook</h1></div> <nav class="mt-6"></nav> <div class="absolute bottom-0 w-full p-6"><button class="flex items-center text-gray-400 hover:text-white"><!> Logout</button></div></aside>');function _e(s,t){H(t,!0);const o=()=>C(ce,"$page",a),[a,r]=T();let n=X(t,"open",15);const e=[{href:"/dashboard",label:"Dashboard",icon:de},{href:"/devices",label:"Devices",icon:oe},{href:"/rules",label:"Forwarding Rules",icon:ne},{href:"/logs",label:"Message Logs",icon:le},{href:"/settings",label:"Settings",icon:ve}];function i(){E.logout(),A("/login")}var d=me(),l=m($(d),2);Y(l,21,()=>e,ee,(S,f)=>{var p=ge();p.__click=()=>n(!1);var z=$(p);te(z,()=>N(f).icon,(F,q)=>{q(F,{class:"mr-3 h-5 w-5"})});var B=m(z);h(p),D(()=>{ae(p,"href",N(f).href),O(p,1,`flex items-center px-6 py-3 transition-colors hover:bg-gray-800 ${o().url.pathname===N(f).href?"border-l-4 border-blue-500 bg-gray-800":""}`),j(B,` ${N(f).label??""}`)}),u(S,p)}),h(l);var c=m(l,2),v=$(c);v.__click=i;var k=$(v);ue(k,{class:"mr-3 h-5 w-5"}),I(),h(v),h(c),h(d),D(()=>O(d,1,`fixed inset-y-0 left-0 z-50 w-64 transform bg-gray-900 text-white transition-transform lg:translate-x-0 ${n()?"translate-x-0":"-translate-x-full"}`)),u(s,d),P(),r()}W(["click"]);function be(){const{subscribe:s,set:t,update:o}=G({connected:!1,devices:new Map,recentLogs:[]});let a=null,r;function n(){const d=localStorage.getItem("token");if(!d)return;const l=`ws://localhost:8080/ws/dashboard?token=${d}`;a=new WebSocket(l),a.onopen=()=>{o(c=>({...c,connected:!0}))},a.onclose=()=>{o(c=>({...c,connected:!1})),r=setTimeout(n,5e3)},a.onerror=()=>{a==null||a.close()},a.onmessage=c=>{try{const v=JSON.parse(c.data);e(v)}catch{}}}function e(d){o(l=>{switch(d.type){case"DEVICE_STATUS":{const c=d.data;return l.devices.set(c.device_id,c),{...l,devices:new Map(l.devices)}}case"NEW_LOG":{const c=d.data;return{...l,recentLogs:[c,...l.recentLogs].slice(0,10)}}default:return l}})}function i(){clearTimeout(r),a&&(a.close(),a=null)}return{subscribe:s,connect:n,disconnect:i}}const V=be();var xe=b('<!> <span class="text-green-600">Connected</span>',1),ye=b('<!> <span class="text-red-600">Disconnected</span>',1),we=b('<div class="flex items-center gap-2 text-sm"><!></div>');function Me(s,t){H(t,!1);const o=()=>C(V,"$wsStore",a),[a,r]=T();re();var n=we(),e=$(n);{var i=l=>{var c=xe(),v=g(c);$e(v,{class:"h-4 w-4 text-green-500"}),I(2),u(l,c)},d=l=>{var c=ye(),v=g(c);pe(v,{class:"h-4 w-4 text-red-500"}),I(2),u(l,c)};U(e,l=>{o().connected?l(i):l(d,!1)})}h(n),u(s,n),P(),r()}var ke=b('<header class="flex items-center justify-between border-b bg-white px-6 py-4"><button class="lg:hidden"><!></button> <div class="flex-1"></div> <div class="flex items-center gap-4"><!> <span class="text-sm text-gray-600"> </span> <div class="flex h-8 w-8 items-center justify-center rounded-full bg-gray-200"><!></div></div></header>');function Ne(s,t){H(t,!0);const o=()=>C(E,"$auth",a),[a,r]=T();var n=ke(),e=$(n);e.__click=function(...f){var p;(p=t.onMenuClick)==null||p.apply(this,f)};var i=$(e);fe(i,{class:"h-6 w-6"}),h(e);var d=m(e,4),l=$(d);Me(l,{});var c=m(l,2),v=$(c,!0);h(c);var k=m(c,2),S=$(k);he(S,{class:"h-4 w-4"}),h(k),h(d),h(n),D(()=>{var f;return j(v,(f=o().user)==null?void 0:f.email)}),u(s,n),P(),r()}W(["click"]);var Se=b('<div class="fixed inset-0 z-40 bg-black/50 lg:hidden" role="button" tabindex="-1"></div>'),ze=b('<div class="min-h-screen bg-gray-50"><!> <!> <div class="lg:pl-64"><!> <main class="p-6"><!></main></div></div>');function Ge(s,t){H(t,!0);const o=()=>C(E,"$auth",a),[a,r]=T();let n=K(!1);Z(()=>{!o().isLoading&&!o().isAuthenticated&&A("/login")}),J(()=>{V.connect()}),R(()=>{V.disconnect()});var e=ze(),i=$(e);{var d=f=>{var p=Se();p.__click=()=>L(n,!1),p.__keydown=z=>z.key==="Escape"&&L(n,!1),u(f,p)};U(i,f=>{N(n)&&f(d)})}var l=m(i,2);_e(l,{get open(){return N(n)},set open(f){L(n,f,!0)}});var c=m(l,2),v=$(c);Ne(v,{onMenuClick:()=>L(n,!0)});var k=m(v,2),S=$(k);Q(S,()=>t.children),h(k),h(c),h(e),u(s,e),P(),r()}W(["click","keydown"]);export{Ge as component};
