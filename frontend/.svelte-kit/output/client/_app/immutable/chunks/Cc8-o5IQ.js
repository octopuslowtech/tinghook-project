import{w as l}from"./C1N3qTNx.js";import{a}from"./DtRFns2F.js";function i(){const{subscribe:o,set:s,update:n}=l({user:null,token:null,isAuthenticated:!1,isLoading:!0});return{subscribe:o,login:(e,t)=>{localStorage.setItem("token",t),a.setToken(t),s({user:e,token:t,isAuthenticated:!0,isLoading:!1})},logout:()=>{localStorage.removeItem("token"),a.setToken(null),s({user:null,token:null,isAuthenticated:!1,isLoading:!1})},setUser:e=>{n(t=>({...t,user:e,isAuthenticated:!!e,isLoading:!1}))},setLoading:e=>{n(t=>({...t,isLoading:e}))},init:async()=>{const e=localStorage.getItem("token");if(e){a.setToken(e);try{const t=await a.getMe();s({user:t,token:e,isAuthenticated:!0,isLoading:!1})}catch{localStorage.removeItem("token"),a.setToken(null),s({user:null,token:null,isAuthenticated:!1,isLoading:!1})}}else s({user:null,token:null,isAuthenticated:!1,isLoading:!1})}}}const c=i();export{c as a};
